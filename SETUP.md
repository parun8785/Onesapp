# セットアップガイド

このガイドに従って、「Ones」アプリケーションをセットアップしてください。

## ステップ1: 依存関係のインストール

```bash
npm install
```

## ステップ2: Supabaseプロジェクトの作成

1. [Supabase](https://supabase.com/)にアクセス
2. 「New Project」をクリック
3. プロジェクト名を入力（例：ones-bar）
4. データベースパスワードを設定
5. リージョンを選択（日本の場合は「Northeast Asia (Tokyo)」を推奨）
6. 「Create new project」をクリック

## ステップ3: 環境変数の設定

1. プロジェクトが作成されたら、左メニューの「Settings」→「API」を開く
2. 以下の情報をコピー：
   - **Project URL**（例：https://xxxxx.supabase.co）
   - **anon public key**（長い文字列）

3. プロジェクトのルートディレクトリに`.env.local`ファイルを作成：

```env
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

⚠️ **重要**: `xxxxx`の部分を実際の値に置き換えてください！

## ステップ4: データベーススキーマの作成

1. Supabaseダッシュボードの左メニューから「SQL Editor」を開く
2. 「New query」をクリック
3. `supabase-schema.sql`ファイルの内容を**すべてコピー**
4. SQL Editorに貼り付け
5. 右下の「Run」ボタンをクリック

✅ 成功すると「Success. No rows returned」と表示されます

### トラブルシューティング

エラーが出た場合：
- すでにテーブルが存在する場合は、先にテーブルを削除してから再実行
- または、Supabaseダッシュボードの「Table Editor」からテーブルを確認

## ステップ5: メール認証の設定（オプション）

開発環境では、メール認証をスキップできます：

1. Supabaseダッシュボードの「Authentication」→「Settings」を開く
2. 「Email Auth」セクションを見つける
3. 「Enable email confirmations」を**オフ**にする（開発環境のみ）

⚠️ **本番環境では必ずオンにしてください！**

## ステップ6: 開発サーバーの起動

```bash
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開きます。

## ステップ7: 動作確認

### 1. アカウント作成
- 「アカウントを作成」をクリック
- 名前、メールアドレス、パスワードを入力
- 「サインアップ」をクリック

### 2. 在庫管理のテスト
1. 「在庫管理」タブを開く
2. 「商品を追加」をクリック
3. 商品名を入力（例：「ウイスキー」）
4. 「追加」をクリック
5. 商品カードの「棚卸」ボタンをクリック
6. 数量を入力（例：3.5）
7. 「保存」をクリック

✅ 商品が表示され、数量が更新されれば成功！

### 3. To-doリストのテスト
1. 「To-doリスト」タブを開く
2. タスクを入力（例：「グラスを洗う」）
3. 「全体共有にする」にチェックを入れる
4. 「追加」をクリック

✅ Todoが表示されれば成功！

### 4. 共有リストのテスト
1. 「共有リスト」タブを開く
2. 「リストを作成」をクリック
3. タイトルと内容を入力
4. 「作成」をクリック

✅ リストが左側に表示されれば成功！

## よくある問題と解決方法

### 問題1: 「作成できない」「追加できない」

**原因**: 環境変数が正しく設定されていない

**解決方法**:
1. `.env.local`ファイルが存在するか確認
2. ファイルの内容が正しいか確認
3. 開発サーバーを再起動（Ctrl+Cで停止後、`npm run dev`）

### 問題2: 「エラーが発生しました」と表示される

**原因**: データベーススキーマが正しく作成されていない

**解決方法**:
1. Supabaseの「Table Editor」で以下のテーブルが存在するか確認：
   - users
   - inventory_items
   - inventory_history
   - todos
   - shared_lists
2. 存在しない場合は、ステップ4を再実行

### 問題3: ログインできない

**原因**: メール認証が有効になっている

**解決方法**:
1. Supabaseの「Authentication」→「Users」を開く
2. ユーザーが作成されているか確認
3. ステップ5を実行してメール認証を無効化
4. または、受信メールから認証リンクをクリック

### 問題4: データが表示されない

**原因**: Row Level Security (RLS)の設定問題

**解決方法**:
1. `supabase-schema.sql`を再実行
2. Supabaseの「Authentication」→「Policies」でポリシーが作成されているか確認

## サポート

問題が解決しない場合は、以下を確認してください：
1. ブラウザの開発者ツール（F12）でエラーメッセージを確認
2. Supabaseダッシュボードの「Logs」でエラーを確認

---

セットアップが完了したら、`README.md`でアプリの使い方を確認してください！

